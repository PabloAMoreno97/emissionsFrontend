<div class="p-4 bg-gray-100 rounded-2xl shadow-sm mb-6 flex flex-wrap gap-6 items-end">
  <div class="flex flex-col">
    <label class="text-sm font-semibold text-gray-700 mb-2">Country</label>
    <div class="relative">
      <select
        [(ngModel)]="selectedCountry"
        (change)="applyFilters()"
        class="appearance-none border border-gray-300 text-gray-700 rounded-xl px-4 py-2.5 w-52 bg-white shadow-sm 
               focus:ring-2 focus:ring-green-400 focus:border-green-400 transition-all cursor-pointer hover:border-gray-400"
      >
        <option value="">All</option>
        <option *ngFor="let country of countries" [value]="country.name">
          {{ country.name }}
        </option>
      </select>
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-gray-500 absolute right-3 top-3 pointer-events-none" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </div>
  </div>

  <div class="flex flex-col">
    <label class="text-sm font-semibold text-gray-700 mb-2">Activity</label>
    <div class="relative">
      <select
        [(ngModel)]="selectedActivity"
        (change)="applyFilters()"
        class="appearance-none border border-gray-300 text-gray-700 rounded-xl px-4 py-2.5 w-52 bg-white shadow-sm 
               focus:ring-2 focus:ring-green-400 focus:border-green-400 transition-all cursor-pointer hover:border-gray-400"
      >
        <option value="">All</option>
        <option *ngFor="let activity of activities" [value]="activity.name">
          {{ activity.name }}
        </option>
      </select>
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-gray-500 absolute right-3 top-3 pointer-events-none" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </div>
  </div>

  <div class="flex flex-col">
    <label class="text-sm font-semibold text-gray-700 mb-2">Emission Type</label>
    <div class="relative">
      <select
        [(ngModel)]="selectedEmissionType"
        (change)="applyFilters()"
        class="appearance-none border border-gray-300 text-gray-700 rounded-xl px-4 py-2.5 w-52 bg-white shadow-sm 
               focus:ring-2 focus:ring-green-400 focus:border-green-400 transition-all cursor-pointer hover:border-gray-400"
      >
        <option value="">All</option>
        <option *ngFor="let type of emissionTypes" [value]="type.name">
          {{ type.name }}
        </option>
      </select>
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-gray-500 absolute right-3 top-3 pointer-events-none" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </div>
  </div>
</div>

<div *ngIf="!isLoading" class="mb-6">
  <apx-chart
    [series]="chartOptions.series"
    [chart]="chartOptions.chart"
    [xaxis]="chartOptions.xaxis"
    [stroke]="chartOptions.stroke"
    [dataLabels]="chartOptions.dataLabels"
    [title]="chartOptions.title"
    [legend]="chartOptions.legend"
    [grid]="chartOptions.grid"
  ></apx-chart>
</div>

<div *ngIf="isLoading" class="flex justify-center py-10 mb-6">
  <div class="animate-spin rounded-full h-10 w-10 border-4 border-green-400 border-t-transparent"></div>
</div>

<div class="relative overflow-x-auto shadow-md sm:rounded-lg" *ngIf="emissions.length > 0; else noData">
  <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
    <thead class="ext-xs text-gray-700 uppercase bg-gray-200 dark:bg-gray-700 dark:text-gray-400">
      <tr>
        <th scope="col" class="px-6 py-3">Year</th>
        <th scope="col" class="px-6 py-3">Emissions</th>
        <th scope="col" class="px-6 py-3">Type</th>
        <th scope="col" class="px-6 py-3">Country</th>
        <th scope="col" class="px-6 py-3">Activity</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let e of emissions" class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 border-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600">
        <td class="px-6 py-4">{{ e.year }}</td>
        <td class="px-6 py-4">{{ e.emissions }}</td>
        <td class="px-6 py-4">{{ e.emission_type }}</td>
        <td class="px-6 py-4">{{ e.country }}</td>
        <td class="px-6 py-4">{{ e.activity }}</td>
      </tr>
    </tbody>
  </table>
</div>

<ng-template #noData>
  <div class="text-center py-10 text-gray-500">No emissions found</div>
</ng-template>